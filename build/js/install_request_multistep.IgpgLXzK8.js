/*! For license information please see install_request_multistep.IgpgLXzK8.js.LICENSE.txt */
!function(){const e=PRHelper.getHook(),t=PRHelper.getHTML(),n=PRHelper.getType(),i=PRHelper.getTool(),s=PRHelper.getForm(),a=PRHelper.getRequest(),r=PRHelper.getSetting(),c=t.getElement(".pr-multistep-wrap"),o=t.getAttribute(c,"id"),l=window.PR_MULTISTEPS[o];t.hide(t.getParent(t.getElement(".submit-action",c)));let m=0,p="",_=!1;function g(){return t.is("#accept_terms_of_use",":checked")}function u(){return t.is("#confirmation",":checked")}e.on("focus",(()=>{_||t.setElementActivity("button#check_serial",!0)}),'.pr--field[name="serial"]'),e.on("click",(e=>{const s=t.getTarget(e,"button"),c=t.getParent(s,'[data-name="serial_check"]');if(t.isElement(c)){const e=t.serializeForm(c);if(!n.isEmpty(e.serial)&&!n.isEmpty(e.component)){t.setElementActivity(s,!1);const n=t.getElement(".serial-information",c);_=!0,l.stop(!1),l.showMessage(""),a.ajax(r.getOption("ajax.check_serial")).addNonce().onSuccess((i=>{p=e.serial,m=parseInt(i.installation),t.fadeIn(n,{start:()=>{t.replace(i.html,n,!1)}}),t.setValue('.pr--field[name="serial"]',"")})).onError((e=>{l.showMessage(i.error2string(e)),t.empty(n),m=0,t.setElementActivity(s,!0)})).onFinally((()=>{_=!1,l.resume()})).send(e)}}}),"button#check_serial"),e.on("change",(e=>{t.setElementActivity(t.getElement("#step_content_consent .next-action"),g(),!1)}),"#accept_terms_of_use"),e.on("change",(e=>{t.setElementActivity(t.getElement("#step_content_requirements .next-action"),u(),!1)}),"#confirmation"),e.addFilter(`multistep_${o}_can_goto_next_step`,(async(e,o)=>{if(!0===e){let l=!1;switch(o.getCurrentStepName()){case"serial_check":(m<0||n.isEmpty(m))&&(l="check_serial_first");break;case"requirements":t.is('[data-name="requirements"] #confirmation',":checked")||(l="check_confirmation");break;case"setup_information":const o=s.getInvalidFields('.pr-multistep-step-content[data-name="setup_information"]');n.isEmpty(o)||(n.each(o,(e=>{s.showFieldMessage(e.field,r.getOption(`field.invalid.${e.type}`,""),!0,!0)})),l="fill_required_fields");break;case"consent":if(g()){let n=t.serializeForm(c);n.serial=p,n.installation_id=m,await a.ajax(r.getOption("ajax.submit_installation")).addNonce().onError((t=>{e=i.error2string(t)})).send(n)}else l="accept_terms_of_use_first"}l&&(e=r.getOption(`message.${l}`,!1))}return e})),e.addAction(`multistep_${o}_step_changed`,(e=>{switch(e.getCurrentStepName()){case"requirements":t.setElementActivity(t.getElement("#step_content_requirements .next-action"),u(),!1);break;case"consent":t.setElementActivity(t.getElement("#step_content_consent .next-action"),g(),!1);break;case"thank_you":e.stop(!1)}}))}();