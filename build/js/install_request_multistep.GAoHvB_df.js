/*! For license information please see install_request_multistep.GAoHvB_df.js.LICENSE.txt */
!function(){const e=PRHelper.getHook(),t=PRHelper.getHTML(),r=PRHelper.getType(),i=PRHelper.getTool(),n=(PRHelper.getFormat(),PRHelper.getRequest()),s=PRHelper.getSetting(),a=t.getElement(".pr-multistep-wrap"),l=t.getAttribute(a,"id"),o=window.PR_MULTISTEPS[l];let c=0,m=!1;e.on("focus",(()=>{m||t.setElementActivity("button#check_serial",!0)}),'.pr--field[name="serial"]'),e.on("click",(e=>{const a=t.getTarget(e,"button"),l=t.getParent(a,'[data-name="serial_check"]');if(t.isElement(l)){const e=t.serializeForm(l);if(!r.isEmpty(e.serial)&&!r.isEmpty(e.component)){t.setElementActivity(a,!1);const r=t.getElement(".serial-information",l);m=!0,o.stop(),n.ajax(s.getOption("ajax.check_serial")).addNonce().onSuccess((e=>{c=parseInt(e.installation),t.fadeIn(r,{start:()=>{t.replace(e.html,r,!1)}}),t.setValue('.pr--field[name="serial"]',"")})).onError((e=>{o.showMessage(i.error2string(e)),t.empty(r),c=0,t.setElementActivity(a,!0)})).onFinally((()=>{m=!1,o.resume()})).send(e)}}}),"button#check_serial"),e.addFilter(`1multistep_${l}_can_goto_next_step`,((e,i)=>{if(!0===e){let n=!1;switch(i.getCurrentStepName()){case"serial_check":(c<0||r.isEmpty(c))&&(n="check_serial_first");break;case"requirements":t.is('[data-name="requirements"] #confirmation',":checked")||(n="check_confirmation")}n&&(e=s.getOption(`errors.${n}`,!1))}return e}))}();